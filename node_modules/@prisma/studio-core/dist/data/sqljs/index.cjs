"use strict";var l=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var w=(t,e)=>{for(var o in e)l(t,o,{get:e[o],enumerable:!0})},x=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of v(e))!h.call(t,r)&&r!==o&&l(t,r,{get:()=>e[r],enumerable:!(n=m(e,r))||n.enumerable});return t};var y=t=>x(l({},"__esModule",{value:!0}),t);var b={};w(b,{createSQLJSExecutor:()=>S});module.exports=y(b);function S(t){return{execute:e=>{let{parameters:o,sql:n,transformations:r}=e,u=t.prepare(n);u.bind(o);let a=[];try{for(;u.step();){let s=u.getAsObject();a.push(s)}if(!r||Object.keys(r).length===0)return Promise.resolve([null,a]);for(let s of a)for(let c in r){let f=r[c],i=s[c];if(f==="json-parse"){if(typeof i=="string")try{s[c]=JSON.parse(i)}catch(p){console.error(`Failed to JSON.parse column "${c}" with value: ${i}`,p)}continue}}return Promise.resolve([null,a])}catch(s){return Promise.resolve([s])}}}}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vZGF0YS9zcWxqcy9pbmRleC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHR5cGUgeyBEYXRhYmFzZSwgU3FsVmFsdWUgfSBmcm9tIFwic3FsLmpzXCI7XG5cbmltcG9ydCB0eXBlIHsgRXhlY3V0b3IgfSBmcm9tIFwiLi4vZXhlY3V0b3JcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNRTEpTRXhlY3V0b3IoZGF0YWJhc2U6IERhdGFiYXNlKTogRXhlY3V0b3Ige1xuICByZXR1cm4ge1xuICAgIGV4ZWN1dGU6IChxdWVyeSkgPT4ge1xuICAgICAgY29uc3QgeyBwYXJhbWV0ZXJzLCBzcWwsIHRyYW5zZm9ybWF0aW9ucyB9ID0gcXVlcnk7XG5cbiAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGRhdGFiYXNlLnByZXBhcmUoc3FsKTtcbiAgICAgIHN0YXRlbWVudC5iaW5kKHBhcmFtZXRlcnMgYXMgU3FsVmFsdWVbXSk7XG5cbiAgICAgIGNvbnN0IHJvd3MgPSBbXTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgd2hpbGUgKHN0YXRlbWVudC5zdGVwKCkpIHtcbiAgICAgICAgICBjb25zdCByb3cgPSBzdGF0ZW1lbnQuZ2V0QXNPYmplY3QoKTtcblxuICAgICAgICAgIHJvd3MucHVzaChyb3cpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0cmFuc2Zvcm1hdGlvbnMgfHwgT2JqZWN0LmtleXModHJhbnNmb3JtYXRpb25zKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtudWxsLCByb3dzXSkgYXMgbmV2ZXI7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBjb2x1bW4gaW4gdHJhbnNmb3JtYXRpb25zKSB7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2Zvcm1hdGlvbiA9IHRyYW5zZm9ybWF0aW9uc1tjb2x1bW5dO1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByb3dbY29sdW1uXTtcblxuICAgICAgICAgICAgaWYgKHRyYW5zZm9ybWF0aW9uID09PSBcImpzb24tcGFyc2VcIikge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIHJvd1tjb2x1bW5dID0gSlNPTi5wYXJzZSh2YWx1ZSkgYXMgbmV2ZXI7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBKU09OLnBhcnNlIGNvbHVtbiBcIiR7Y29sdW1ufVwiIHdpdGggdmFsdWU6ICR7dmFsdWV9YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFuc2Zvcm1hdGlvbiBzYXRpc2ZpZXMgdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW251bGwsIHJvd3NdKSBhcyBuZXZlcjtcbiAgICAgIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW2Vycm9yIGFzIEVycm9yXSk7XG4gICAgICB9XG4gICAgfSxcbiAgfTtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICJ5YUFBQSxJQUFBQSxFQUFBLEdBQUFDLEVBQUFELEVBQUEseUJBQUFFLElBQUEsZUFBQUMsRUFBQUgsR0FJTyxTQUFTSSxFQUFvQkMsRUFBOEIsQ0FDaEUsTUFBTyxDQUNMLFFBQVVDLEdBQVUsQ0FDbEIsR0FBTSxDQUFFLFdBQUFDLEVBQVksSUFBQUMsRUFBSyxnQkFBQUMsQ0FBZ0IsRUFBSUgsRUFFdkNJLEVBQVlMLEVBQVMsUUFBUUcsQ0FBRyxFQUN0Q0UsRUFBVSxLQUFLSCxDQUF3QixFQUV2QyxJQUFNSSxFQUFPLENBQUMsRUFFZCxHQUFJLENBQ0YsS0FBT0QsRUFBVSxLQUFLLEdBQUcsQ0FDdkIsSUFBTUUsRUFBTUYsRUFBVSxZQUFZLEVBRWxDQyxFQUFLLEtBQUtDLENBQUcsQ0FDZixDQUVBLEdBQUksQ0FBQ0gsR0FBbUIsT0FBTyxLQUFLQSxDQUFlLEVBQUUsU0FBVyxFQUM5RCxPQUFPLFFBQVEsUUFBUSxDQUFDLEtBQU1FLENBQUksQ0FBQyxFQUdyQyxRQUFXQyxLQUFPRCxFQUNoQixRQUFXRSxLQUFVSixFQUFpQixDQUNwQyxJQUFNSyxFQUFpQkwsRUFBZ0JJLENBQU0sRUFDdkNFLEVBQVFILEVBQUlDLENBQU0sRUFFeEIsR0FBSUMsSUFBbUIsYUFBYyxDQUNuQyxHQUFJLE9BQU9DLEdBQVUsU0FDbkIsR0FBSSxDQUNGSCxFQUFJQyxDQUFNLEVBQUksS0FBSyxNQUFNRSxDQUFLLENBQ2hDLE9BQVNDLEVBQU8sQ0FDZCxRQUFRLE1BQU0sZ0NBQWdDSCxDQUFNLGlCQUFpQkUsQ0FBSyxHQUFJQyxDQUFLLENBQ3JGLENBR0YsUUFDRixDQUdGLENBR0YsT0FBTyxRQUFRLFFBQVEsQ0FBQyxLQUFNTCxDQUFJLENBQUMsQ0FDckMsT0FBU0ssRUFBZ0IsQ0FDdkIsT0FBTyxRQUFRLFFBQVEsQ0FBQ0EsQ0FBYyxDQUFDLENBQ3pDLENBQ0YsQ0FDRixDQUNGIiwKICAibmFtZXMiOiBbInNxbGpzX2V4cG9ydHMiLCAiX19leHBvcnQiLCAiY3JlYXRlU1FMSlNFeGVjdXRvciIsICJfX3RvQ29tbW9uSlMiLCAiY3JlYXRlU1FMSlNFeGVjdXRvciIsICJkYXRhYmFzZSIsICJxdWVyeSIsICJwYXJhbWV0ZXJzIiwgInNxbCIsICJ0cmFuc2Zvcm1hdGlvbnMiLCAic3RhdGVtZW50IiwgInJvd3MiLCAicm93IiwgImNvbHVtbiIsICJ0cmFuc2Zvcm1hdGlvbiIsICJ2YWx1ZSIsICJlcnJvciJdCn0K